<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Qu·∫£n L√Ω H·ªì S∆° Kh√°ch H√†ng</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            display: flex;
        }
        .sidebar {
            width: 250px;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            background: #343a40;
            color: white;
            padding: 20px;
        }
        .sidebar a {
            color: white;
            text-decoration: none;
            display: block;
            padding: 10px;
        }
        .sidebar a:hover {
            background: #495057;
            border-radius: 5px;
        }
        .content {
            margin-left: 270px;
            width: calc(100% - 270px);
            padding: 20px;
        }
        .customer-card {
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
        }
        .order-history {
            margin-top: 10px;
        }
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
                padding: 10px;
            }
            .content {
                margin-left: 210px;
                width: calc(100% - 210px);
            }
        }
        @media (max-width: 576px) {
            .sidebar {
                display: none;
            }
            .content {
                margin-left: 0;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <a class="navbar-brand fw-bold" href="{% url 'manager' %}">Qu·∫£n l√Ω v·∫≠n chuy·ªÉn</a>
        <a href="{% url 'shipping-menu' %}">üì¶ ƒê∆°n v·∫≠n chuy·ªÉn</a>
        <a href="{% url 'shipping-process' %}">üöõ Qu√° tr√¨nh v·∫≠n chuy·ªÉn</a>
        <a href="{% url 'price-list' %}">üí∞ B·∫£ng gi√° d·ªãch v·ª•</a>
        <a href="{% url 'dashboard-report' %}">üìä Dashboard & B√°o c√°o</a>
        <a href="{% url 'feedback' %}">‚≠ê ƒê√°nh gi√° & Ph·∫£n h·ªìi</a>
        <a href="{% url 'customer-profile' %}">üìù H·ªì s∆° kh√°ch h√†ng</a>
        <a href="{% url 'nhanvien' %}">üìù H·ªì s∆° nh√¢n vi√™n</a>
    </div>

    <!-- N·ªôi dung ch√≠nh -->
    <!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω H·ªì S∆° Kh√°ch H√†ng</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .container {
            background: #ffffff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        h2 {
            color: #007bff;
            text-align: center;
        }
        .table {
            background: white;
            border-radius: 5px;
            overflow: hidden;
        }
        .form-control {
            border-radius: 20px;
            padding-left: 15px;
        }
        .highlight {
            background-color: yellow;
            font-weight: bold;
        }
        .btn-edit {
            background-color: #ffc107;
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 5px;
        }
        .btn-delete {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 5px;
        }
        body {
            display: flex;
            justify-content: center; /* CƒÉn gi·ªØa theo chi·ªÅu ngang */
            align-items: center; /* CƒÉn gi·ªØa theo chi·ªÅu d·ªçc */
            height: 100vh; /* Chi·ªÅu cao to√†n m√†n h√¨nh */
            background-color: #f8f9fa;
            margin: 0;
        }
        
        .container {
            background: #ffffff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center; /* CƒÉn gi·ªØa n·ªôi dung */
            width: 60%; /* Gi·∫£m chi·ªÅu r·ªông ƒë·ªÉ v·ª´a v·∫∑n */
            max-width: 800px; /* Gi·ªõi h·∫°n k√≠ch th∆∞·ªõc t·ªëi ƒëa */
        }
        
        h2 {
            color: #007bff;
        }
        
        .form-control {
            width: 80%; /* Thu nh·ªè √¥ t√¨m ki·∫øm */
            margin: 0 auto; /* CƒÉn gi·ªØa √¥ t√¨m ki·∫øm */
            border-radius: 20px;
            padding-left: 15px;
        }
        
        .table-container {
            overflow-x: auto; /* ƒê·∫£m b·∫£o b·∫£ng kh√¥ng b·ªã tr√†n */
        }
        
        .table {
            width: 100%;
            font-size: 14px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
        }
        
        .btn-edit, .btn-delete {
            padding: 5px 8px;
            font-size: 12px; /* Gi·∫£m k√≠ch th∆∞·ªõc n√∫t */
        }
        
        @media (max-width: 768px) {
            .container {
                width: 90%; /* ƒêi·ªÅu ch·ªânh tr√™n m√†n h√¨nh nh·ªè */
            }
            
            .form-control {
                width: 100%;
            }
        }
        
        
    </style>
</head>
<body>

    <div class="container">
        <h2>üìã Qu·∫£n L√Ω H·ªì S∆° Kh√°ch H√†ng</h2>
    
        <!-- √î t√¨m ki·∫øm -->
        <input type="text" id="search" class="form-control mb-3" placeholder="üîç T√¨m ki·∫øm theo t√™n kh√°ch h√†ng..." onkeyup="filterCustomers()">
    
        <!-- B·∫£ng danh s√°ch kh√°ch h√†ng -->
        <div class="table-container">
            <table class="table table-bordered">
                <thead class="table-dark">
                    <tr>
                        <th>M√£ ƒë∆°n</th>
                        <th>T√™n kh√°ch h√†ng</th>
                        <th>S·ªë ƒëi·ªán tho·∫°i</th>
                        <th>C√° Koi</th>
                        <th>S·ªë l∆∞·ª£ng</th>
                        <th>V·∫≠n chuy·ªÉn</th>
                        <th>Xu·∫•t ph√°t</th>
                        <th>ƒê√≠ch ƒë·∫øn</th>
                        <th>D·ªãch v·ª•</th>
                        <th>H√†nh ƒë·ªông</th>
                    </tr>
                </thead>
                <tbody id="customerOrders"></tbody>
            </table>
        </div>
    </div>
    

<script>
    function loadCustomerOrders() {
        let orderHistory = JSON.parse(localStorage.getItem("orderHistory")) || [];
        let orderTable = document.getElementById("customerOrders");
        orderTable.innerHTML = ""; // X√≥a danh s√°ch c≈© tr∆∞·ªõc khi c·∫≠p nh·∫≠t m·ªõi

        orderHistory.forEach((order, index) => {
            let row = `<tr class="customer-item">
                <td>${order.invoiceCode}</td>
                <td class="customer-name">${order.customerName}</td>
                <td>${order.customerPhone}</td>
                <td>${order.fishName}</td>
                <td>${order.quantity}</td>
                <td>${order.transportMethod}</td>
                <td>${order.origin}</td>
                <td>${order.destination}</td>
                <td>${order.additionalServices.join(", ")}</td>
                <td>
                    <button class="btn-edit" onclick="editCustomer(${index})">‚úèÔ∏è S·ª≠a</button>
                    <button class="btn-delete" onclick="deleteCustomer(${index})">üóëÔ∏è X√≥a</button>
                </td>
            </tr>`;
            orderTable.innerHTML += row;
        });
    }

    function filterCustomers() {
        let input = document.getElementById("search").value.toLowerCase();
        let customerRows = document.querySelectorAll("#customerOrders .customer-item");

        customerRows.forEach(row => {
            let nameCell = row.querySelector(".customer-name");
            let customerName = nameCell.textContent.toLowerCase();
            if (customerName.includes(input)) {
                row.style.display = "";
                highlightText(nameCell, input); // L√†m n·ªïi b·∫≠t t·ª´ kh√≥a t√¨m ki·∫øm
            } else {
                row.style.display = "none";
            }
        });
    }

    function highlightText(element, keyword) {
        let text = element.textContent;
        let regex = new RegExp(`(${keyword})`, "gi");
        element.innerHTML = text.replace(regex, '<span class="highlight">$1</span>');
    }

    function deleteCustomer(index) {
        let orderHistory = JSON.parse(localStorage.getItem("orderHistory")) || [];
        if (confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a kh√°ch h√†ng n√†y kh√¥ng?")) {
            orderHistory.splice(index, 1);
            localStorage.setItem("orderHistory", JSON.stringify(orderHistory));
            loadCustomerOrders();
        }
    }

    function editCustomer(index) {
        let orderHistory = JSON.parse(localStorage.getItem("orderHistory")) || [];
        let order = orderHistory[index];

        let newName = prompt("Nh·∫≠p t√™n kh√°ch h√†ng m·ªõi:", order.customerName);
        let newPhone = prompt("Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i m·ªõi:", order.customerPhone);
        let newFish = prompt("Nh·∫≠p lo·∫°i C√° Koi:", order.fishName);
        let newQuantity = prompt("Nh·∫≠p s·ªë l∆∞·ª£ng:", order.quantity);
        let newTransport = prompt("Nh·∫≠p ph∆∞∆°ng th·ª©c v·∫≠n chuy·ªÉn:", order.transportMethod);
        let newOrigin = prompt("Nh·∫≠p ƒëi·ªÉm xu·∫•t ph√°t:", order.origin);
        let newDestination = prompt("Nh·∫≠p ƒëi·ªÉm ƒë·∫øn:", order.destination);
        let newServices = prompt("Nh·∫≠p d·ªãch v·ª• (c√°ch nhau b·ªüi d·∫•u ph·∫©y):", order.additionalServices.join(", "));

        if (newName && newPhone && newFish && newQuantity && newTransport && newOrigin && newDestination && newServices) {
            orderHistory[index] = {
                invoiceCode: order.invoiceCode,
                customerName: newName,
                customerPhone: newPhone,
                fishName: newFish,
                quantity: newQuantity,
                transportMethod: newTransport,
                origin: newOrigin,
                destination: newDestination,
                additionalServices: newServices.split(",").map(s => s.trim())
            };

            localStorage.setItem("orderHistory", JSON.stringify(orderHistory));
            loadCustomerOrders();
        }
    }

    // T·ª± ƒë·ªông t·∫£i danh s√°ch khi m·ªü trang
    window.onload = loadCustomerOrders;
</script>

</body>
</html>

    </body>
    </html>
    
